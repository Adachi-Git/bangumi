import{d as H,r as f,o as L,c as l,a as t,t as a,w as d,e as v,F as g,b as m,n as $,f as r}from"./index-3vTmfSdM.js";import{c as _}from"./common-8KoIMbCC.js";const I={key:0,class:"topic",id:"topic"},J={class:"topic-title"},x={class:"topic-info"},B={class:"topic-author"},S={class:"topic-time"},V={class:"topic-relative"},j={class:"topic-relative-subject"},A=t("div",{class:"tip"},"关联的讨论",-1),E=["src"],U={class:"title"},D=["innerHTML"],F={key:0,class:"divider"},O={key:1,class:"topic-comment"},Q={class:"topic-comment-title"},q=t("div",{class:"title"},"精选留言",-1),z=t("div",{style:{flex:"1"}},null,-1),G={class:"topic-comment-item"},K=["src","onClick"],P={class:"comment-content"},W={class:"info"},X=["onClick"],Y={class:"time"},Z=["innerHTML","onClick"],b=t("div",{style:{height:"12px"}},null,-1),tt={class:"topic-comment-item"},et=["src","onClick"],ot={class:"comment-content"},st={class:"info"},it=["onClick"],nt={class:"time"},ct=["innerHTML","onClick"],lt={key:2,class:"topic-space"},_t=H({__name:"TopicView",setup(at){const s=f({}),h=f(),C={loadTopicDetail:async i=>{s.value=i,await $();const n=h.value;_.injectImageClick(n)}},N=i=>{const n=(i||"").trim(),e="　　",o=e+n.replace(/&nbsp;/g," ").trim().replace(/(\r\n|\n|\r)\s+/g,"$1").replace(/(\r\n|\n|\r)/g,`$1${e}`);return console.log(o),o},w=(i,n,e)=>{const o=i.target;if(_.injectHandleItemClick(o))return;_.scrollIntoView(i,document.getElementById("topic"),e==null);const c=(e==null?void 0:e.replyJs)||"",R=n.replyJs||"",k=c.length>0,y=k?c:R,u=e||n;if(window.android){if(y.length>0){k&&(u.replyQuote=_.handleQuote(u.userName,u.replyContent)),window.android.onReplyUser(c.length>0?c:y,JSON.stringify(e||n));return}window.android.onNeedLogin()}},T=i=>{_.scrollIntoView(i,document.getElementById("topic"),!0),window.android&&window.android.onReplyNew()},M=i=>{window.android&&window.android.onClickRelated(JSON.stringify(i))},p=i=>{window.android&&window.android.onClickUser(i.userId)};return L(()=>{window.topic=C,window.mounted=!0}),(i,n)=>s.value.content||s.value.comments?(r(),l("div",I,[t("div",J,a(s.value.title),1),t("div",x,[t("div",B,a(s.value.userName),1),t("div",S,a(s.value.time),1)]),t("div",V,[t("div",j,[A,t("div",{class:"relative",onClick:n[0]||(n[0]=d(e=>M(s.value),["stop"]))},[t("img",{src:s.value.headerAvatar,alt:"img"},null,8,E),t("div",U,"# "+a(s.value.headerName),1)])])]),t("div",{class:"topic-content",ref_key:"topicContentRef",ref:h,innerHTML:N(s.value.content)},null,8,D),s.value.content?(r(),l("hr",F)):v("",!0),s.value.content?(r(),l("div",O,[t("div",Q,[q,z,t("div",{class:"write",onClick:n[1]||(n[1]=d(e=>T(e),["stop"]))},"写留言")]),(r(!0),l(g,null,m(s.value.comments||[],e=>(r(),l("div",G,[t("img",{class:"avatar",src:e.userAvatar,alt:"img",onClick:d(o=>p(e),["stop"])},null,8,K),t("div",P,[t("div",W,[t("div",{class:"user-name",onClick:d(o=>p(e),["stop"])},a(e.userName),9,X),t("div",Y,a(e.time),1)]),t("div",{class:"topic-html",innerHTML:e.replyContent,onClick:d(o=>w(o,e,null),["stop"])},null,8,Z),b,(r(!0),l(g,null,m(e.topicSubReply||[],o=>(r(),l("div",tt,[t("img",{class:"avatar sub",src:o.userAvatar,alt:"img",onClick:d(c=>p(o),["stop"])},null,8,et),t("div",ot,[t("div",st,[t("div",{class:"user-name",onClick:d(c=>p(o),["stop"])},a(o.userName),9,it),t("div",nt,a(o.time),1)]),t("div",{class:"topic-html",innerHTML:o.replyContent,onClick:d(c=>w(c,e,o),["stop"])},null,8,ct)])]))),256))])]))),256))])):v("",!0),s.value.content?(r(),l("div",lt," 我是有底线的 ")):v("",!0)])):v("",!0)}});export{_t as default};
