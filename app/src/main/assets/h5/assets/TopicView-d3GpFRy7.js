import{d as H,r as f,o as L,c as a,a as t,t as d,w as c,e as v,F as g,b as C,n as $,f as r}from"./index-rKUtB4UX.js";import{c as _}from"./common-lLZLEzU9.js";const I={key:0,class:"topic",id:"topic"},J={class:"topic-title"},x={class:"topic-info"},B={class:"topic-author"},S={class:"topic-time"},V={class:"topic-relative"},j={class:"topic-relative-subject"},A=t("div",{class:"tip"},"关联的讨论",-1),E=["src"],U={class:"title"},D=["innerHTML"],F={key:0,class:"divider"},O={key:1,class:"topic-comment"},Q={class:"topic-comment-title"},q=t("div",{class:"title"},"精选留言",-1),z=t("div",{style:{flex:"1"}},null,-1),G={class:"topic-comment-item"},K=["src","onClick"],P={class:"comment-content"},W=["onClick"],X=["onClick"],Y={class:"time"},Z=["innerHTML","onClick"],b=t("div",{style:{height:"12px"}},null,-1),tt={class:"topic-comment-item"},et=["src","onClick"],ot=["onClick"],it={class:"info"},st=["onClick"],nt={class:"time"},ct=["innerHTML"],lt={key:2,class:"topic-space"},_t=H({__name:"TopicView",setup(at){const i=f({}),k=f(),m={loadTopicDetail:async s=>{i.value=s,await $();const n=k.value;_.injectImageClick(n)}},N=s=>{const n=(s||"").trim(),e="　　",o=e+n.replace(/&nbsp;/g," ").trim().replace(/(\r\n|\n|\r)\s+/g,"$1").replace(/(\r\n|\n|\r)/g,`$1${e}`);return console.log(o),o},u=(s,n,e)=>{const o=s.target;if(_.injectHandleItemClick(o))return;_.scrollIntoView(s,document.getElementById("topic"),e==null);const l=(e==null?void 0:e.replyJs)||"",R=n.replyJs||"",w=l.length>0,y=w?l:R,h=e||n;if(window.android){if(y.length>0){w&&(h.replyQuote=_.handleQuote(h.userName,h.replyContent)),window.android.onReplyUser(l.length>0?l:y,JSON.stringify(e||n));return}window.android.onNeedLogin()}},T=s=>{_.scrollIntoView(s,document.getElementById("topic"),!0),window.android&&window.android.onReplyNew()},M=s=>{window.android&&window.android.onClickRelated(JSON.stringify(s))},p=s=>{window.android&&window.android.onClickUser(s.userId||"")};return L(()=>{window.topic=m,window.mounted=!0}),(s,n)=>i.value.content||i.value.comments?(r(),a("div",I,[t("div",J,d(i.value.title),1),t("div",x,[t("div",B,d(i.value.userName),1),t("div",S,d(i.value.time),1)]),t("div",V,[t("div",j,[A,t("div",{class:"relative",onClick:n[0]||(n[0]=c(e=>M(i.value),["stop"]))},[t("img",{src:i.value.headerAvatar,alt:"img"},null,8,E),t("div",U,"# "+d(i.value.headerName),1)])])]),t("div",{class:"topic-content",ref_key:"topicContentRef",ref:k,innerHTML:N(i.value.content)},null,8,D),i.value.content?(r(),a("hr",F)):v("",!0),i.value.content?(r(),a("div",O,[t("div",Q,[q,z,t("div",{class:"write",onClick:n[1]||(n[1]=c(e=>T(e),["stop"]))},"写留言")]),(r(!0),a(g,null,C(i.value.comments||[],e=>(r(),a("div",G,[t("img",{class:"avatar",src:e.userAvatar,alt:"img",onClick:c(o=>p(e),["stop"])},null,8,K),t("div",P,[t("div",{class:"info",onClick:c(o=>u(o,e,null),["stop"])},[t("div",{class:"user-name",onClick:c(o=>p(e),["stop"])},d(e.userName),9,X),t("div",Y,d(e.time),1)],8,W),t("div",{class:"topic-html",innerHTML:e.replyContent,onClick:c(o=>u(o,e,null),["stop"])},null,8,Z),b,(r(!0),a(g,null,C(e.topicSubReply||[],o=>(r(),a("div",tt,[t("img",{class:"avatar sub",src:o.userAvatar,alt:"img",onClick:c(l=>p(o),["stop"])},null,8,et),t("div",{class:"comment-content",onClick:c(l=>u(l,e,o),["stop"])},[t("div",it,[t("div",{class:"user-name",onClick:c(l=>p(o),["stop"])},d(o.userName),9,st),t("div",nt,d(o.time),1)]),t("div",{class:"topic-html",innerHTML:o.replyContent},null,8,ct)],8,ot)]))),256))])]))),256))])):v("",!0),i.value.content?(r(),a("div",lt," 我是有底线的 ")):v("",!0)])):v("",!0)}});export{_t as default};
