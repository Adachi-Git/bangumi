import{C as B,c as d,B as k,a as T,W as x}from"./BottomSpinnerView-pFLKlfyq.js";import{R as N}from"./RelativeItemView-IgMK1nBH.js";import{d as R,r as o,a as b,o as D,c as _,b as n,t as r,e as a,u as w,g as f,w as g,n as h,h as C}from"./index-TkjgZVOG.js";const H={key:0,class:"topic",id:"topic"},I={class:"topic-title"},J={class:"topic-info"},L={class:"topic-author"},M={class:"topic-time"},P=["innerHTML"],z={key:0,class:"divider"},y=10,q=R({__name:"TopicView",setup(E){const t=o({}),m=o(),u=o(new Date().getDate()),s=o(1),i=o("desc"),c=b([]),p=o("哼！Bangumi老娘我是有底线的人"),S={loadTopicDetail:async e=>{t.value=e,await h(),d.optContentJs(m.value)}},V=async e=>{const v=window.android.onLoadComments(s.value,y,i.value),l=JSON.parse(v);l.length==0?e.complete():(await d.delay(200),c.push(...l),s.value++,await h(),l.length<y?e.complete():e.loaded())};return D(()=>{window.robotSay=e=>{p.value=e},window.changeCommentSort=e=>{i.value=e,s.value=1,c.length=0,u.value++},window.topic=S,window.mounted=!0}),(e,v)=>t.value.id?(C(),_("div",H,[n("div",I,r(t.value.title),1),n("div",J,[n("div",L,r(t.value.userName),1),n("div",M,r(t.value.time),1)]),a(N,{related:t.value.related},null,8,["related"]),n("div",{class:"topic-content",ref_key:"topicContentRef",ref:m,innerHTML:w(d).optText(t.value.content)},null,8,P),t.value.content?(C(),_("div",z)):f("",!0),a(B,{target:"#topic",comments:c,sort:i.value},null,8,["comments","sort"]),a(w(x),{class:"loading",target:"#topic",identifier:u.value,distance:300,onInfinite:V},{spinner:g(()=>[a(k)]),complete:g(()=>[a(T,{message:p.value},null,8,["message"])]),_:1},8,["identifier"])])):f("",!0)}});export{q as default};
