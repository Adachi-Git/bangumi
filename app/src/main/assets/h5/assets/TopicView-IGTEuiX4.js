import{d as H,r as f,o as L,c as d,a as t,t as a,w as c,e as h,F as g,b as C,n as $,f as r}from"./index-d9vlfaLW.js";import{c as _}from"./common-lLZLEzU9.js";const I={key:0,class:"topic",id:"topic"},J={class:"topic-title"},x={class:"topic-info"},B={class:"topic-author"},S={class:"topic-time"},V={class:"topic-relative"},j={class:"topic-relative-subject"},A=t("div",{class:"tip"},"关联的讨论",-1),E=["src"],U={class:"title"},D=["innerHTML"],F={key:0,class:"divider"},O={class:"topic-comment"},Q={class:"topic-comment-title"},q=t("div",{class:"title"},"精选留言",-1),z=t("div",{style:{flex:"1"}},null,-1),G={class:"topic-comment-item"},K=["src","onClick"],P={class:"comment-content"},W=["onClick"],X=["onClick"],Y={class:"time"},Z=["innerHTML","onClick"],b=t("div",{style:{height:"12px"}},null,-1),tt={class:"topic-comment-item"},et=["src","onClick"],it=["onClick"],ot={class:"info"},st=["onClick"],nt={class:"time"},ct=["innerHTML"],lt={key:1,class:"topic-space"},_t=H({__name:"TopicView",setup(at){const o=f({}),k=f(),m={loadTopicDetail:async s=>{o.value=s,await $();const n=k.value;_.injectImageClick(n)}},N=s=>{const n=(s||"").trim(),e="　　",i=e+n.replace(/&nbsp;/g," ").trim().replace(/(\r\n|\n|\r)\s+/g,"$1").replace(/(\r\n|\n|\r)/g,`$1${e}`);return console.log(i),i},v=(s,n,e)=>{const i=s.target;if(_.injectHandleItemClick(i))return;_.scrollIntoView(s,document.getElementById("topic"),e==null);const l=(e==null?void 0:e.replyJs)||"",R=n.replyJs||"",w=l.length>0,y=w?l:R,u=e||n;if(window.android){if(y.length>0){w&&(u.replyQuote=_.handleQuote(u.userName,u.replyContent)),window.android.onReplyUser(l.length>0?l:y,JSON.stringify(e||n));return}window.android.onNeedLogin()}},T=s=>{_.scrollIntoView(s,document.getElementById("topic"),!0),window.android&&window.android.onReplyNew()},M=s=>{window.android&&window.android.onClickRelated(JSON.stringify(s))},p=s=>{window.android&&window.android.onClickUser(s.userId||"")};return L(()=>{window.topic=m,window.mounted=!0}),(s,n)=>o.value.content||o.value.comments?(r(),d("div",I,[t("div",J,a(o.value.title),1),t("div",x,[t("div",B,a(o.value.userName),1),t("div",S,a(o.value.time),1)]),t("div",V,[t("div",j,[A,t("div",{class:"relative",onClick:n[0]||(n[0]=c(e=>M(o.value),["stop"]))},[t("img",{src:o.value.headerAvatar,alt:"img"},null,8,E),t("div",U,"# "+a(o.value.headerName),1)])])]),t("div",{class:"topic-content",ref_key:"topicContentRef",ref:k,innerHTML:N(o.value.content)},null,8,D),o.value.content?(r(),d("hr",F)):h("",!0),t("div",O,[t("div",Q,[q,z,t("div",{class:"write",onClick:n[1]||(n[1]=c(e=>T(e),["stop"]))},"写留言")]),(r(!0),d(g,null,C(o.value.comments||[],e=>(r(),d("div",G,[t("img",{class:"avatar",src:e.userAvatar,alt:"img",onClick:c(i=>p(e),["stop"])},null,8,K),t("div",P,[t("div",{class:"info",onClick:c(i=>v(i,e,null),["stop"])},[t("div",{class:"user-name",onClick:c(i=>p(e),["stop"])},a(e.userName),9,X),t("div",Y,a(e.time),1)],8,W),t("div",{class:"topic-html",innerHTML:e.replyContent,onClick:c(i=>v(i,e,null),["stop"])},null,8,Z),b,(r(!0),d(g,null,C(e.topicSubReply||[],i=>(r(),d("div",tt,[t("img",{class:"avatar sub",src:i.userAvatar,alt:"img",onClick:c(l=>p(i),["stop"])},null,8,et),t("div",{class:"comment-content",onClick:c(l=>v(l,e,i),["stop"])},[t("div",ot,[t("div",{class:"user-name",onClick:c(l=>p(i),["stop"])},a(i.userName),9,st),t("div",nt,a(i.time),1)]),t("div",{class:"topic-html",innerHTML:i.replyContent},null,8,ct)],8,it)]))),256))])]))),256))]),o.value.content?(r(),d("div",lt," 我是有底线的 ")):h("",!0)])):h("",!0)}});export{_t as default};
