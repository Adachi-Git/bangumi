import{c as s,C as B,B as k,a as T,W as x}from"./BottomSpinnerView-92VUeQAx.js";import{R as N}from"./RelativeItemView-Dy09pSjo.js";import{d as R,r as o,a as b,o as D,c as _,b as n,t as d,e as a,u as w,g as f,w as g,n as h,h as C}from"./index-KoiszNXw.js";const H={key:0,class:"topic",id:"topic"},I={class:"topic-title"},J={class:"topic-info"},L={class:"topic-author"},M={class:"topic-time"},P=["innerHTML"],z={key:0,class:"divider"},y=10,q=R({__name:"TopicView",setup(E){const t=o({}),r=o(),u=o(new Date().getDate()),c=o(1),l=o("desc"),i=b([]),p=o("哼！Bangumi老娘我是有底线的人"),S={loadTopicDetail:async e=>{t.value=e,await h(),s.optContentJs(r.value)}},V=async e=>{const v=window.android.onLoadComments(c.value,y,l.value),m=JSON.parse(v);m.length==0?e.complete():(await s.delay(200),i.push(...m),c.value++,await h(),m.length<y?e.complete():e.loaded())};return D(()=>{window.robotSay=e=>{p.value=e},window.changeCommentSort=e=>{l.value=e,c.value=1,i.length=0,u.value++},s.initComment(()=>i),window.topic=S,window.mounted=!0}),(e,v)=>t.value.id?(C(),_("div",H,[n("div",I,d(t.value.title),1),n("div",J,[n("div",L,d(t.value.userName),1),n("div",M,d(t.value.time),1)]),a(N,{related:t.value.related},null,8,["related"]),n("div",{class:"topic-content",ref_key:"topicContentRef",ref:r,innerHTML:w(s).optText(t.value.content)},null,8,P),t.value.content?(C(),_("div",z)):f("",!0),a(B,{target:"#topic",comments:i,sort:l.value},null,8,["comments","sort"]),a(w(x),{class:"loading",target:"#topic",identifier:u.value,distance:300,onInfinite:V},{spinner:g(()=>[a(k)]),complete:g(()=>[a(T,{message:p.value},null,8,["message"])]),_:1},8,["identifier"])])):f("",!0)}});export{q as default};
